(function(){var tools={trim:function(v)
{return(typeof v=='string')?v.replace(/^\s+/,'').replace(/\s+$/,''):v;},isEmpty:function(v)
{return(typeof v=='undefined'||/^\d*$/.test(v));},visitUrl:function(settings)
{if(!this.isEmpty(settings['adUrl']))
{window.open(settings['adUrl'],settings['target']);}}};var defaultSettings={alignTo:'tl',mirror:true,colorStart:'#DADADA',colorIn:'#DADADA',thumbPath:'',imgPath:'',audioPath:'',adUrl:'',openIn:-1,closeIn:-1,target:'_blank'};window['printCornerAd']=function(settings)
{function imgClick()
{tools.visitUrl(settings);};function leafClickedActions()
{if(typeof expanded=='undefined'||expanded==false)
{expandLeaf();}
else
{shrinkLeaf();}};function expandLeaf()
{expanded=true;cornerContainer.css({'width':500,'height':500});backgroundFillBig.show();backgroundFillBig.show().stop().animate({path:pathBig},500,'linear',function()
{if(settings['closeIn']>0)
{setTimeout(function(){settings['closeIn']=-1;if(expanded)
{shrinkLeaf();}},settings['closeIn']*1000)}});setMirror(settings['imgPath']);pageLeaf.stop().animate({path:pathLeafBig,transform:(isLeft)?'T0,0':'T100,0'},500,'linear');pageLeafMirror.stop().animate({path:pathLeafBig,transform:(isLeft)?'T0,0':'T100,0'},500,'linear');pageLeafShadow.stop().animate({path:pathLeafBig,transform:(isLeft)?'T-4,6':'T104,6'},500,'linear');backgroundFillSmall.hide();};function shrinkLeaf()
{setTimeout(function()
{expanded=false;pageLeaf.stop().animate({path:pathLeaf,transform:(isLeft)?'T0,0':'T400,0'},400,'linear');pageLeafMirror.stop().animate({path:pathLeaf,transform:(isLeft)?'T0,0':'T400,0'},400,'linear');pageLeafShadow.stop().animate({transform:(isLeft)?'T-4,4':'T404,4',path:pathLeaf},400,'linear');backgroundFillBig.stop().animate({path:pathSmall},400,'linear',function(){backgroundFillSmall.show();backgroundFillBig.hide();setMirror(settings['thumbPath']);cornerContainer.css({'width':'100px','height':'100px'});swingLeaf();});},500);};var swingTo=0;function swingLeaf()
{swingTo=(swingTo+1)%2;pageLeaf.stop().animate({path:(swingTo)?pathLeafSwung:pathLeaf},1500,'linear',function(){swingLeaf();});pageLeafMirror.stop().animate({path:(swingTo)?pathLeafSwung:pathLeaf},1500,'linear');pageLeafShadow.stop().animate({path:(swingTo)?pathLeafSwung:pathLeaf},1500,'linear');};function setMirror(url)
{if(settings['mirror'])
{function flipImage(e,width)
{if(typeof width=='undefined')
{setTimeout(function()
{flipImage(e,e.attr('width'));},20);return;}
else
{e[0].setAttribute('transform','scale(-1,1) translate('+(-1*width)+',0)');}};pageLeaf.attr('fill','url("'+url+'")');var patternSelector=$(pageLeaf.node).attr('fill').replace('url(#','').replace(')',''),img=$('#'+patternSelector+' image'),width=img.attr('width');if(typeof width=='undefined')
{flipImage(img);}
else
{flipImage(img,width);}}};var $=jQuery,isLeft=true,cornerContainer;settings=$.extend({},defaultSettings,settings);for(var i in settings)
{settings[i]=tools.trim(settings[i]);}
if(settings['alignTo']=='tr')
{isLeft=false;}
if(settings['target']=='_blank')
{settings['target']='cornerAdLink';}
if(!tools.isEmpty(settings['audioPath']))
{$('body').append($('<div style="display:none;width:1px;heigth:1px;"><audio src="'+settings['audioPath']+'" autoplay loop preload="auto"/></div>'));}
if(!tools.isEmpty(settings['imgPath']))
{if(tools.isEmpty(settings['thumbPath']))settings['thumbPath']=settings['imgPath'];cornerContainer=$('#cornerContainer');if(cornerContainer.length==0){cornerContainer=$('<div id="cornerContainer"></div>');$('body').append(cornerContainer);}
cornerContainer.attr('style','position:absolute;width:100px;height:100px;top:0;z-index:999999;overflow:hidden;'+((isLeft)?'left':'right')+':0;').html('<div style="position:absolute;'+((isLeft)?'left':'right')+':0;"></div>');var paper=new Raphael(cornerContainer.find('div')[0],500,500);var pathSmall=(isLeft)?'M 0,0 H 100 L 0,100 Z':'M 400,0 L 500,100 L 500,0 Z',pathBig=(isLeft)?'M 0,0 H 400 L 0,400 Z':'M 100,0 L 500,400 L 500,0 Z',pathLeaf=(isLeft)?'M 100,0 Q 75,25 75,75 Q 25,75 0,100 Z':'M 0,0 Q 25,25 25,75 Q 75,75 100,100 Z',pathLeafBig=(isLeft)?'M 400,0 Q 300,150 300,300 Q 150,300 0,400 Z':'M 0,0 Q 100,100 100,300 Q 300,300 400,400 Z',pathLeafSwung=(isLeft)?'M 100,0 Q 75,25 75,90 Q 25,75 0,100 Z':'M 0,0 Q 25,25 25,90 Q 75,75 100,100 Z';var backgroundFillSmall=paper.path(pathSmall),backgroundFillBig=paper.path(pathBig),pageLeafShadow=paper.path(pathLeaf),pageLeaf=paper.path(pathLeaf),pageLeafMirror=paper.path(pathLeaf);var bgFillSmallAttrs={fill:"url('"+settings['thumbPath']+"')",'stroke-width':0},bgFillBigAttrs={fill:"url('"+settings['imgPath']+"')",'stroke-width':0,'id':'BigAdvert'},gradient=(isLeft)?'315-'+settings['colorStart']+'-'+settings['colorIn']:'225-'+settings['colorStart']+'-'+settings['colorIn'],leafAttrs={'id':'cornerLeaf','gradient':gradient,'stroke-width':0,'opacity':1},leafMirrorAttrs={'gradient':gradient,'stroke-width':0,'opacity':0.3},leafShadowAttrs={fill:settings['colorStart'],'opacity':0.6,'stroke-width':0};backgroundFillSmall.attr(bgFillSmallAttrs);backgroundFillBig.attr(bgFillBigAttrs);backgroundFillSmall.node.setAttribute('style','cursor:pointer');backgroundFillBig.node.setAttribute('style','cursor:pointer');pageLeafMirror.node.setAttribute('style','cursor:pointer');backgroundFillBig.animate({path:pathSmall},1,'linear');backgroundFillBig.hide();pageLeafShadow.attr(leafShadowAttrs);pageLeafShadow.transform((isLeft)?'T-4,4':'T404,4');pageLeaf.attr(leafAttrs);setMirror(settings['thumbPath']);pageLeaf.transform((isLeft)?'T0,0':'T400,0');pageLeafMirror.attr(leafMirrorAttrs);pageLeafMirror.transform((isLeft)?'T0,0':'T400,0');swingLeaf();pageLeafMirror.click(function()
{leafClickedActions();});$(pageLeafMirror.node).mouseenter(function()
{leafClickedActions();});$(backgroundFillBig.node).mouseleave(function()
{shrinkLeaf();});backgroundFillSmall.click(function()
{imgClick();});backgroundFillBig.click(function()
{imgClick();});if(settings['openIn']>0)
{setTimeout(function()
{settings['openIn']=-1;if(typeof expanded=='undefined'||expanded==false)
{expandLeaf();}},settings['openIn']*1000);}}};})();